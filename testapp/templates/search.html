{% extends 'base.html' %}
{% load humanize %}

{% block title %}å•†å“æ¤œç´¢çµæœ | Business Casual{% endblock %}

{% block contents %}
<section class="page-section" id="products">
  <div class="container">
    <h2 class="text-center mb-4">æ¤œç´¢çµæœ</h2>

    <!-- ğŸ” æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
    <form method="get" action="{% url 'testapp:search' %}" class="mb-4">

      <!-- å·¦å¯„ã›ç”¨ã®ã‚³ãƒ³ãƒ†ãƒŠ -->
      <div class="d-flex flex-column align-items-start">

        <!-- å•†å“åæ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ -->
        <div class="input-group mb-2" style="max-width:400px;">
          <input type="text" name="q" value="{{ keyword }}" class="form-control" placeholder="å•†å“åã§æ¤œç´¢">
        </div>

        <!-- ã‚«ãƒ†ã‚´ãƒªé¸æŠ -->
        <div class="mb-2" style="max-width:200px;">
          <select name="category" class="form-select w-100">
            <option value="">ã™ã¹ã¦ã®ã‚«ãƒ†ã‚´ãƒª</option>
            {% for cat in categories %}
              <option value="{{ cat.id }}" {% if cat.id|stringformat:"s" == selected_category %}selected{% endif %}>
                {{ cat.title }}
              </option>
            {% endfor %}
          </select>
        </div>

        <!-- æ¤œç´¢ãƒœã‚¿ãƒ³ -->
        <button type="submit" class="btn btn-primary">æ¤œç´¢</button>

      </div>
    </form>

    <!-- å•†å“ä¸€è¦§ -->
    <div class="row">
      {% for item in products %}
      <div class="col-md-6 mb-4">
        <a href="{% url 'testapp:item_detail' item.pk %}" style="text-decoration:none; color:inherit;">
          <div class="card shadow-sm">

            {% if item.image1 %}
              <img src="{{ item.image1.url }}" class="card-img-top img-fluid"
                   style="width:100%; height:200px; object-fit:contain;" alt="{{ item.title }}">
            {% else %}
              <img src="https://via.placeholder.com/600x400?text=No+Image"
                   class="card-img-top img-fluid"
                   style="width:100%; height:200px; object-fit:contain;" alt="No image">
            {% endif %}

            <div class="card-body">
              <h5 class="card-title">{{ item.title }}</h5>
              <p class="card-text">{{ item.comment|default:"å•†å“ã®èª¬æ˜ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚"|truncatechars:120 }}</p>
              <p class="fs-5 fw-semibold text-dark">
                {% if item.price %}Â¥{{ item.price|intcomma }}{% else %}ä¾¡æ ¼æœªå®š{% endif %}
              </p>
            </div>

          </div>
        </a>
      </div>
      {% empty %}
        <p class="text-muted mt-3 text-center">å•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
      {% endfor %}
    </div>

  </div>
</section>
{% endblock %}
